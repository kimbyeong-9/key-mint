# λΈ”λ΅μ²΄μΈ μ‚¬μ©μ λ°μ΄ν„° μ €μ¥ κ°€μ΄λ“

## π“– κ°μ”

μ΄ ν”„λ΅μ νΈλ” **μ‚¬μ©μ λ°μ΄ν„°λ¥Ό λΈ”λ΅μ²΄μΈμ— μ•μ „ν•κ² μ €μ¥**ν•λ” μ‹μ¤ν…μ„ κµ¬ν„ν•©λ‹λ‹¤.

### ν•µμ‹¬ κ°λ…

```
μ‚¬μ©μ νμ›κ°€μ… β†’ λ°μ΄ν„° μ•”νΈν™” β†’ λΈ”λ΅μ²΄μΈ μ €μ¥ β†’ μκµ¬ λ³΄μ΅΄
```

## π” λ°μ΄ν„° μ €μ¥ λ°©μ‹

### κΈ°λ³Έ UserRegistry (ν„μ¬) γ…‹γ…‹

**μ €μ¥λλ” λ°μ΄ν„°:**
- β… μ‚¬μ©μλ… ν•΄μ‹ (keccak256)
- β… λ“±λ΅ μ‹κ°„
- β… μ§€κ°‘ μ£Όμ†

**μ¥μ :**
- κ°„λ‹¨ν•κ³  μ•μ „
- ν”„λΌμ΄λ²„μ‹ λ³΄νΈ

**λ‹¨μ :**
- μ ν•μ μΈ λ°μ΄ν„°λ§ μ €μ¥
- ν•΄μ‹λ§μΌλ΅λ” μ›λ³Έ λ°μ΄ν„° λ³µκµ¬ λ¶κ°€

---

### ν–¥μƒλ UserRegistryEnhanced (μƒλ΅μ΄ λ²„μ „)

**μ €μ¥λλ” λ°μ΄ν„°:**
- β… μ‚¬μ©μλ… ν•΄μ‹ (κ²€μ¦μ©)
- β… **μ•”νΈν™”λ μ΄λ©”μΌ**
- β… **μ•”νΈν™”λ μ¶”κ°€ λ°μ΄ν„°** (JSON ν•νƒ)
- β… **IPFS ν”„λ΅ν•„ μ΄λ―Έμ§€ ν•΄μ‹**
- β… λ“±λ΅/μ—…λ°μ΄νΈ μ‹κ°„
- β… μΈμ¦ μƒνƒ
- β… μ§€κ°‘ μ£Όμ†

**μ¥μ :**
- λ” λ§μ€ λ°μ΄ν„° μ €μ¥ κ°€λ¥
- μ•”νΈν™”λ΅ ν”„λΌμ΄λ²„μ‹ λ³΄νΈ
- λ³ΈμΈλ§ λ³µνΈν™” κ°€λ¥
- IPFSμ™€ ν†µν•© (μ΄λ―Έμ§€ λ“±)

**λ‹¨μ :**
- κ°€μ¤λΉ„κ°€ λ” λ†’μ
- ν΄λΌμ΄μ–ΈνΈμ—μ„ μ•”νΈν™”/λ³µνΈν™” ν•„μ”

---

## π”’ λ³΄μ• λ©”μ»¤λ‹μ¦

### 1. ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“ μ•”νΈν™”

μ‚¬μ©μ λ°μ΄ν„°λ” **λΈ”λ΅μ²΄μΈμ— μ €μ¥λκΈ° μ „μ— λΈλΌμ°μ €μ—μ„ μ•”νΈν™”**λ©λ‹λ‹¤:

```javascript
μ‚¬μ©μ μ…λ ¥ β†’ λΈλΌμ°μ €μ—μ„ μ•”νΈν™” β†’ λΈ”λ΅μ²΄μΈ μ €μ¥
```

**μ‚¬μ© κΈ°μ :**
- Web Crypto API
- AES-GCM 256bit μ•”νΈν™”
- μ‚¬μ©μ μ§€κ°‘ μ„λ…μΌλ΅ ν‚¤ μƒμ„±

### 2. λ°μ΄ν„° νλ¦„

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ 1. μ‚¬μ©μ μ…λ ¥  β”‚
β”‚ - μ΄λ©”μΌ      β”‚
β”‚ - μ‚¬μ©μλ…    β”‚
β”‚ - μ¶”κ°€ μ •λ³΄   β”‚
β””β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”
       β†“
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ 2. μ•”νΈν™”     β”‚
β”‚ (λΈλΌμ°μ €)    β”‚
β”‚ - AES-GCM   β”‚
β”‚ - μ§€κ°‘ μ„λ…ν‚¤ β”‚
β””β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”
       β†“
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ 3. λΈ”λ΅μ²΄μΈ   β”‚
β”‚   μ €μ¥       β”‚
β”‚ - Ethereum  β”‚
β”‚ - Immutable β”‚
β””β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”
       β†“
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚ 4. μκµ¬ λ³΄μ΅΄  β”‚
β”‚ - μ„λ³€μ΅° λ¶κ°€ β”‚
β”‚ - ν¬λ…μ„±     β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

---

## π’΅ μ•”νΈν™” λ°©μ‹

### λ€μΉ­ν‚¤ μ•”νΈν™” (AES-GCM)

```javascript
// μ•”νΈν™” ν‚¤ μƒμ„±
const encryptionKey = await generateKeyFromSignature(
  walletSignature
);

// λ°μ΄ν„° μ•”νΈν™”
const encryptedData = await encryptData(
  userData,
  encryptionKey
);

// λΈ”λ΅μ²΄μΈ μ €μ¥
await userRegistry.register(
  usernameHash,
  encryptedEmail,
  encryptedData,
  ipfsHash
);
```

### λ³µνΈν™” (λ³ΈμΈλ§ κ°€λ¥)

```javascript
// μ§€κ°‘ μ„λ…μΌλ΅ ν‚¤ λ³µμ›
const decryptionKey = await generateKeyFromSignature(
  walletSignature
);

// λ°μ΄ν„° λ³µνΈν™”
const userData = await decryptData(
  encryptedData,
  decryptionKey
);
```

---

## π― μ‚¬μ© μ‹λ‚λ¦¬μ¤

### μ‹λ‚λ¦¬μ¤ 1: νμ›κ°€μ…

1. μ‚¬μ©μκ°€ νΌ μ‘μ„± (μ΄λ©”μΌ, μ‚¬μ©μλ… λ“±)
2. λΈλΌμ°μ €μ—μ„ λ°μ΄ν„° μ•”νΈν™”
3. μ¤λ§νΈ μ»¨νΈλ™νΈ νΈμ¶
4. λΈ”λ΅μ²΄μΈμ— μ•”νΈν™”λ λ°μ΄ν„° μ €μ¥
5. νΈλμ­μ… ν•΄μ‹ λ°ν™

### μ‹λ‚λ¦¬μ¤ 2: ν”„λ΅ν•„ μ΅°ν

1. μ‚¬μ©μ μ§€κ°‘ μ—°κ²°
2. λΈ”λ΅μ²΄μΈμ—μ„ μ•”νΈν™”λ λ°μ΄ν„° κ°€μ Έμ¤κΈ°
3. μ§€κ°‘ μ„λ…μΌλ΅ ν‚¤ μƒμ„±
4. λ°μ΄ν„° λ³µνΈν™”
5. ν”„λ΅ν•„ ν‘μ‹

### μ‹λ‚λ¦¬μ¤ 3: λ‹¤λ¥Έ μ‚¬μ©μ ν”„λ΅ν•„ λ³΄κΈ°

1. λΈ”λ΅μ²΄μΈμ—μ„ κ³µκ° μ •λ³΄λ§ μ΅°ν
   - μ‚¬μ©μλ… ν•΄μ‹
   - λ“±λ΅ μ‹κ°„
   - IPFS ν”„λ΅ν•„ μ΄λ―Έμ§€
   - μΈμ¦ μƒνƒ
2. μ•”νΈν™”λ λ°μ΄ν„°λ” **λ³µνΈν™” λ¶κ°€** (λ³ΈμΈλ§ κ°€λ¥)

---

## π“ λ°μ΄ν„° μ €μ¥ κµ¬μ΅°

### UserProfile κµ¬μ΅°μ²΄

```solidity
struct UserProfile {
    bytes32 usernameHash;      // ν•΄μ‹ (κ³µκ°)
    bytes encryptedEmail;      // μ•”νΈν™” (λΉ„κ³µκ°)
    bytes encryptedData;       // μ•”νΈν™” (λΉ„κ³µκ°)
    string ipfsHash;           // IPFS ν•΄μ‹ (κ³µκ°)
    uint256 createdAt;         // μ‹κ°„ (κ³µκ°)
    uint256 updatedAt;         // μ‹κ°„ (κ³µκ°)
    bool exists;               // μƒνƒ (κ³µκ°)
    bool isVerified;           // μΈμ¦ (κ³µκ°)
}
```

### μ €μ¥ λΉ„μ© (κ°€μ¤λΉ„)

| μ‘μ—… | μμƒ κ°€μ¤ | ETH (100 gwei) |
|------|----------|----------------|
| κΈ°λ³Έ λ“±λ΅ | ~100,000 | ~0.01 ETH |
| ν–¥μƒλ λ“±λ΅ | ~200,000 | ~0.02 ETH |
| ν”„λ΅ν•„ μ—…λ°μ΄νΈ | ~80,000 | ~0.008 ETH |

---

## π”§ κµ¬ν„ λ°©λ²•

### 1. μ»¨νΈλ™νΈ λ°°ν¬

```bash
# μ»΄νμΌ
npx hardhat compile

# Sepolia ν…μ¤νΈλ„·μ— λ°°ν¬
npx hardhat run scripts/deploy.js --network sepolia

# λ°°ν¬λ μ£Όμ†λ¥Ό .env.localμ— μ¶”κ°€
VITE_USER_REGISTRY_ADDRESS=0x...
```

### 2. ν”„λ΅ νΈμ—”λ“ ν†µν•©

```javascript
import { useRegisterEnhanced } from './hooks/useUserRegistry';

function Signup() {
  const { registerEnhanced } = useRegisterEnhanced();

  const handleSubmit = async (formData) => {
    // 1. λ°μ΄ν„° μ•”νΈν™”
    const encrypted = await encryptUserData(formData);

    // 2. λΈ”λ΅μ²΄μΈ μ €μ¥
    await registerEnhanced(
      encrypted.usernameHash,
      encrypted.email,
      encrypted.data,
      ipfsHash
    );
  };
}
```

---

## β οΈ μ£Όμμ‚¬ν•­

### 1. ν”„λΌμ΄λ²„μ‹

- β… λ―Όκ°ν• λ°μ΄ν„°λ” λ°λ“μ‹ μ•”νΈν™”
- β… μ•”νΈν™” ν‚¤λ” μ‚¬μ©μ μ§€κ°‘μ—μ„ μƒμ„±
- β ν‰λ¬ΈμΌλ΅ μ €μ¥ κΈμ§€

### 2. κ°€μ¤λΉ„

- λ°μ΄ν„°κ°€ λ§μ„μλ΅ κ°€μ¤λΉ„ μ¦κ°€
- ν° λ°μ΄ν„°λ” IPFSμ— μ €μ¥ν•κ³  ν•΄μ‹λ§ λΈ”λ΅μ²΄μΈμ— μ €μ¥ κ¶μ¥

### 3. λ¶λ³€μ„±

- λΈ”λ΅μ²΄μΈμ— μ €μ¥λ λ°μ΄ν„°λ” **μ‚­μ  λ¶κ°€**
- μ—…λ°μ΄νΈλ§ κ°€λ¥
- μλ»λ λ°μ΄ν„° μ €μ¥ μ‹ μμ • μ–΄λ ¤μ›€

### 4. ν‚¤ κ΄€λ¦¬

- μ•”νΈν™” ν‚¤ λ¶„μ‹¤ μ‹ λ³µνΈν™” λ¶κ°€
- μ§€κ°‘ κ°μΈν‚¤ κ΄€λ¦¬ μ¤‘μ”

---

## π€ λ‹¤μ λ‹¨κ³„

### Phase 1: κΈ°λ³Έ μ•”νΈν™” κµ¬ν„
- [x] UserRegistryEnhanced μ»¨νΈλ™νΈ μ‘μ„±
- [ ] μ•”νΈν™” μ ν‹Έλ¦¬ν‹° ν•¨μ μ‘μ„±
- [ ] νμ›κ°€μ… νμ΄μ§€ μ—…λ°μ΄νΈ
- [ ] ν…μ¤νΈ

### Phase 2: IPFS ν†µν•©
- [ ] IPFS μ΄λ―Έμ§€ μ—…λ΅λ“
- [ ] ν”„λ΅ν•„ μ΄λ―Έμ§€ ν‘μ‹
- [ ] λ©”νƒ€λ°μ΄ν„° μ €μ¥

### Phase 3: κ³ κΈ‰ κΈ°λ¥
- [ ] μ‚¬μ©μ μΈμ¦ μ‹μ¤ν…
- [ ] λ³µκµ¬ λ©”μ»¤λ‹μ¦
- [ ] λ°μ΄ν„° λ°±μ—…

---

## π“ μ°Έκ³  μλ£

- [Web Crypto API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API)
- [Ethereum Data Storage](https://ethereum.org/en/developers/docs/storage/)
- [IPFS Documentation](https://docs.ipfs.tech/)
- [OpenZeppelin Contracts](https://docs.openzeppelin.com/contracts/)

---

## β… μ²΄ν¬λ¦¬μ¤νΈ

ν„μ¬ ν”„λ΅μ νΈ μƒνƒ:

- [x] κΈ°λ³Έ UserRegistry κµ¬ν„
- [x] UserRegistryEnhanced μ‘μ„±
- [ ] μ•”νΈν™” μ ν‹Έλ¦¬ν‹° κµ¬ν„
- [ ] ν”„λ΅ νΈμ—”λ“ ν†µν•©
- [ ] ν…μ¤νΈ μ‘μ„±
- [ ] λ°°ν¬

---

**λ§μ§€λ§‰ μ—…λ°μ΄νΈ**: 2025-10-19
**λ²„μ „**: 2.0
**μ‘μ„±μ**: Claude AI Assistant